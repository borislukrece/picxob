(()=>{var e={};e.id=686,e.ids=[686],e.modules={62849:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=62849,e.exports=t},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},85477:e=>{"use strict";e.exports=require("punycode")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},32745:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{GET:()=>c});var i=r(49303),a=r(88716),o=r(60670),u=r(62458);let n=new(r(33064)).lv(process.env.GOOGLE_CLIENT_ID);async function c(e){try{let t=e.nextUrl.searchParams,r=e.headers.get("Authorization"),s=r?.split(" ")[1];if(!s)return Response.json({message:"Unauthorized"},{status:401});let i=await new Promise(async e=>{try{let t=(await n.verifyIdToken({idToken:s||"",audience:process.env.GOOGLE_CLIENT_ID})).getPayload();e(t&&void 0!==t?t:null)}catch(t){e(null)}});if(!i)return Response.json({message:"Unauthorized"},{status:401});let a=parseInt(t.get("page")||"1"),o=parseInt(t.get("entries")||"50"),c=await (0,u.U2)(["SELECT * FROM images WHERE sub = ? ORDER BY created_at DESC LIMIT ? OFFSET ?",[i.sub,o,(a-1)*o]]);if(!(Array.isArray(c)&&c.length>0))return Response.json({totalPage:0,images:[]});c=c.map(e=>(e.id=null,e));let p=await (0,u.U2)("SELECT COUNT(*) AS count FROM images"),l=Array.isArray(p)?p[0].count:0,d=Math.ceil(l/o);return Response.json({totalPage:d,images:c})}catch(e){return Response.json({message:"Failed to get images",error:e.message},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/users/images/route",pathname:"/api/users/images",filename:"route",bundlePath:"app/api/users/images/route"},resolvedPagePath:"C:\\Users\\hp\\Desktop\\projects\\picxob.borislukrece.com\\picxob\\src\\app\\api\\users\\images\\route.tsx",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:d,serverHooks:m}=p,g="/api/users/images/route";function x(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},62458:(e,t,r)=>{"use strict";r.d(t,{U2:()=>a,v_:()=>o});let s=(0,r(69518).createPool)({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME,waitForConnections:!0,connectionLimit:10,queueLimit:0});async function i(e,t){let r="",i=[];switch("string"==typeof e?r=e:Array.isArray(e)&&(r=e[0],i=e[1]||[]),t){case"get":if(!r.startsWith("SELECT"))throw Error("Invalid SQL statement");break;case"post":if(!r.startsWith("INSERT INTO"))throw Error("Invalid SQL statement");break;case"update":if(!r.startsWith("UPDATE"))throw Error("Invalid SQL statement");break;case"delete":if(!r.startsWith("DELETE"))throw Error("Invalid SQL statement")}let[a]=await s.query(r,i);return a}async function a(e){return await i(e,"get")}async function o(e,t=null){let r=await i(e,"post");return await new Promise(async e=>{try{if(t){let s=await a([`SELECT * FROM ${t} WHERE id = ? LIMIT 1`,[r.insertId]]);Array.isArray(s)&&s.length>0&&e(s[0])}else e(null)}catch(t){console.log("Error getting item added: ",t.message),e(null)}})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948,662,64],()=>r(32745));module.exports=s})();