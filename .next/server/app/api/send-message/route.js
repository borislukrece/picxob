(()=>{var e={};e.id=287,e.ids=[287],e.modules={62849:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=62849,e.exports=r},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},6005:e=>{"use strict";e.exports=require("node:crypto")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},77282:e=>{"use strict";e.exports=require("process")},85477:e=>{"use strict";e.exports=require("punycode")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},71576:e=>{"use strict";e.exports=require("string_decoder")},39512:e=>{"use strict";e.exports=require("timers")},24404:e=>{"use strict";e.exports=require("tls")},76224:e=>{"use strict";e.exports=require("tty")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},13324:(e,r,t)=>{"use strict";t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>E,requestAsyncStorage:()=>f,routeModule:()=>h,serverHooks:()=>x,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{POST:()=>m});var i=t(49303),o=t(88716),n=t(60670),a=t(57357),u=t(36352),c=t(62458),p=t(14300),l=t(49788);l.v2.config({cloud_name:"dn5yraber",api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET});let d=l.v2;async function m(e){try{let{prompt:r}=await e.json();if(!r)return Response.json({error:"No prompt provided"});let t=e.headers.get("Authorization"),s=t?.split(" ")[1]||"",i=await (0,a.P)(s),o=i?i.sub:null,n=(0,u.DO)(),l=r.trim().substring(0,880),m=await fetch("https://api-inference.huggingface.co/models/black-forest-labs/FLUX.1-dev",{headers:{Authorization:`Bearer ${process.env.HUGGING_FACE_TOKEN}`,"Content-Type":"application/json"},method:"POST",body:JSON.stringify({inputs:r})});if(!m.ok){let e=await m.text();throw Error(`HTTP error! status: ${m.status}, message: ${e}`)}let h=await m.blob(),f=await new Promise((e,r)=>{new Response(h).arrayBuffer().then(r=>{let t=p.Buffer.from(r).toString("base64");e(t)}).catch(()=>{r(Error("Error reading the file."))})}),g=(await d.uploader.upload(`data:image/jpeg;base64,${f}`,{resource_type:"auto",upload_preset:"ml_default"})).secure_url,x={sub:o,token:n,uri:g,prompt:l},v=await (0,c.v_)(["INSERT INTO images (sub, uri, prompt, token) VALUES (?, ?, ?, ?)",[x.sub,x.uri,x.prompt,x.token]],"images");if(v)return Response.json({image:v},{status:201});throw Error("An unexpected error occurred while saving the image")}catch(e){return Response.json({message:"Failed to send message",error:e.message},{status:500})}}let h=new i.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/send-message/route",pathname:"/api/send-message",filename:"route",bundlePath:"app/api/send-message/route"},resolvedPagePath:"C:\\Users\\hp\\Desktop\\projects\\picxob.borislukrece.com\\picxob\\src\\app\\api\\send-message\\route.tsx",nextConfigOutput:"",userland:s}),{requestAsyncStorage:f,staticGenerationAsyncStorage:g,serverHooks:x}=h,v="/api/send-message/route";function E(){return(0,n.patchFetch)({serverHooks:x,staticGenerationAsyncStorage:g})}},62458:(e,r,t)=>{"use strict";t.d(r,{U2:()=>o,v_:()=>n});let s=(0,t(69518).createPool)({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME,waitForConnections:!0,connectionLimit:10,queueLimit:0});async function i(e,r){let t="",i=[];switch("string"==typeof e?t=e:Array.isArray(e)&&(t=e[0],i=e[1]||[]),r){case"get":if(!t.startsWith("SELECT"))throw Error("Invalid SQL statement");break;case"post":if(!t.startsWith("INSERT INTO"))throw Error("Invalid SQL statement");break;case"update":if(!t.startsWith("UPDATE"))throw Error("Invalid SQL statement");break;case"delete":if(!t.startsWith("DELETE"))throw Error("Invalid SQL statement")}let[o]=await s.query(t,i);return o}async function o(e){return await i(e,"get")}async function n(e,r=null){let t=await i(e,"post");return await new Promise(async e=>{try{if(r){let s=await o([`SELECT * FROM ${r} WHERE id = ? LIMIT 1`,[t.insertId]]);Array.isArray(s)&&s.length>0&&e(s[0])}else e(null)}catch(r){console.log("Error getting item added: ",r.message),e(null)}})}},57357:(e,r,t)=>{"use strict";t.d(r,{P:()=>i});let s=new(t(33064)).lv(process.env.GOOGLE_CLIENT_ID);async function i(e){return await new Promise(async r=>{try{let t=(await s.verifyIdToken({idToken:e||"",audience:process.env.GOOGLE_CLIENT_ID})).getPayload();r(t&&void 0!==t?t:null)}catch(e){r(null)}})}},9576:(e,r,t)=>{"use strict";t.d(r,{Z:()=>c});var s=t(6005),i=t.n(s);let o={randomUUID:i().randomUUID},n=new Uint8Array(256),a=n.length,u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).slice(1));let c=function(e,r,t){if(o.randomUUID&&!r&&!e)return o.randomUUID();let s=(e=e||{}).random||(e.rng||function(){return a>n.length-16&&(i().randomFillSync(n),a=0),n.slice(a,a+=16)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,r){t=t||0;for(let e=0;e<16;++e)r[t+e]=s[e];return r}return function(e,r=0){return(u[e[r+0]]+u[e[r+1]]+u[e[r+2]]+u[e[r+3]]+"-"+u[e[r+4]]+u[e[r+5]]+"-"+u[e[r+6]]+u[e[r+7]]+"-"+u[e[r+8]]+u[e[r+9]]+"-"+u[e[r+10]]+u[e[r+11]]+u[e[r+12]]+u[e[r+13]]+u[e[r+14]]+u[e[r+15]]).toLowerCase()}(s)}},36352:(e,r,t)=>{"use strict";t.d(r,{DO:()=>i,FX:()=>o});var s=t(9576);function i(){let e=(0,s.Z)();return`${e}`}function o(){return"https://picxob.borislukrece.pro"}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,662,64,788],()=>t(13324));module.exports=s})();